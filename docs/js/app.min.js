(()=>{"use strict";const e={spoiler(){document.addEventListener("click",(function(t){const r=t.target.closest("[data-spoiler]");if(r){const t=r.dataset.spoiler;(!t||window.innerWidth<=t)&&e.openSpoiler(r)}}))},dropdown(){let e,t;document.addEventListener("click",(function(r){r.target.closest("[data-dropdown]")?(t=r.target.closest("[data-dropdown]"),t.classList.toggle("_active-dropdown"),t.setAttribute("aria-expanded","true"===t.getAttribute("aria-expanded")?"false":"true"),e=t.nextElementSibling,e.classList.toggle("_active-dropdown-content"),e.setAttribute("aria-hidden","true"===e.getAttribute("aria-hidden")?"false":"true")):document.querySelector("._active-dropdown-content")&&!r.target.closest("._active-dropdown-content")&&document.querySelectorAll("._active-dropdown").forEach((r=>{r.classList.remove("_active-dropdown"),t.setAttribute("aria-expanded","true"===t.getAttribute("aria-expanded")?"false":"true"),r.nextElementSibling.classList.remove("_active-dropdown-content"),e.setAttribute("aria-hidden","true"===e.getAttribute("aria-hidden")?"false":"true")}))}))},openSpoiler(e){e.classList.toggle("_active-spoiler"),e.setAttribute("aria-expanded","true"===e.getAttribute("aria-expanded")?"false":"true");const t=e.nextElementSibling;t.classList.toggle("_active-spoiler-content"),t.setAttribute("aria-hidden","true"===t.getAttribute("aria-hidden")?"false":"true"),t.style.maxHeight=t.style.maxHeight?null:`${t.scrollHeight}px`}},t=e.spoiler;let r;e.dropdown;const o={initModal(){document.addEventListener("click",(function(e){if(e.target.closest("[data-modal]")){const t=e.target.closest("[data-modal]").dataset.modal;if(t){const a=document.getElementById(t),n=(a.querySelector("._modal-body"),a.querySelector("._modal-content"));r=e.target,o.openModal(a,n)}}e.target.matches("._modal-close-trigger")&&document.querySelectorAll("._modal-wrapper").forEach((e=>{if(e){const t=e.querySelector("._modal-content");o.closeModal(e,t,r)}}))}))},openModalIf(e){if(e){const t=document.getElementById(e),a=(t.querySelector("._modal-body"),t.querySelector("._modal-content"));r=document.activeElement,o.openModal(t,a)}},openModal(e,t){document.body.style.paddingRight=`${o.scrollbarWidth()}px`,document.body.classList.add("_lock"),e.classList.add("_show-modal"),t.classList.add("_show-modal"),o.tabLoopControl(e)},closeModal(e,t,r){document.body.classList.remove("_lock"),document.body.style.paddingRight="0px",document.querySelector(".header__wrapper")&&(document.querySelector(".header__wrapper").style.paddingRight="0px"),e.classList.remove("_show-modal"),t.classList.remove("_show-modal"),r&&r.focus()},tabLoopControl(e){const t=e.querySelectorAll("a, button, input, textarea, select"),r=t[0],o=t[t.length-1];e.addEventListener("transitionend",(()=>{e.classList.contains("_show-modal")&&r.focus()})),e.addEventListener("keydown",(function(e){"Tab"!==e.key&&9!==e.keyCode||(e.shiftKey?document.activeElement===r&&(e.preventDefault(),o.focus()):document.activeElement===o&&(e.preventDefault(),r.focus()))}))},scrollbarWidth(){const e=parseInt(document.documentElement.clientWidth);return parseInt(window.innerWidth)-e}},a=o.initModal,n=o.openModalIf;document.addEventListener("DOMContentLoaded",(function(){console.log("%cЗроблено з натхненням! %chttps://www.instagram.com/dmitry_conquer/","color: #8AC6E8; font-size: 14px; padding: 10px 0;","color: blue; font-size: 11px; padding: 5px 0;"),t(),a();let e=JSON.parse(localStorage.getItem("user-info"))||[];const r=document.querySelector(".modal__main input");0==e.length?(n("modal-entry"),document.querySelector(".modal__main").addEventListener("submit",(t=>{t.preventDefault(),""!=r.value&&(e={userName:r.value,isRegistered:!0},localStorage.setItem("user-info",JSON.stringify(e)),n("modal-greeting"),document.querySelector(".modal-greeting__title span").innerHTML=r.value)}))):(document.querySelector(".modal-come-back__title span").innerText=e.userName,n("modal-come-back"));let o=JSON.parse(localStorage.getItem("tasks-list"))||[];JSON.parse(localStorage.getItem("tasks-list-complited"));const i=document.querySelector(":root"),l=document.querySelector(".app__add"),s=document.querySelector(".app__list"),d=document.querySelector(".app__remove"),c=document.querySelector(".app__check-all"),p=document.querySelector("[type=file]"),u=document.querySelector("._files-container"),m=document.querySelector(".clr-theme__input");let g="";function y(e,t){t.innerHTML=0==e.length?'<li class="_empty-list">Ой-Ой, здається ваш список порожній!</li>':e.map(((e,t)=>`\n              <li class="app__item item-app">\n                <input class="item-app__input visually-hidden" type="checkbox" id="item-${t}" data-i="${t}" ${1==e.done?"checked":""}>\n                <label class="item-app__label" for="item-${t}" >\n                   <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#4682b4" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" id="checkmark">\n                      <polyline points="3 12 9 17 21 3" />\n                   </svg>\n                   ${e.name}\n                </label>\n                ${""==e.desc&&""==e.imageSrc?"":"\n                <button class=\"item-app__show-more\" type=\"button\" aria-label='Показати опис' data-spoiler>\n                   <svg class='icon-arrow'>\n                      <use href='./sprites/sprite.svg#icon-arrow'></use>\n                   </svg>\n                </button>"}\n       \n                <div class="item-app__desc">\n                      ${""!=e.desc?`<p>${e.desc}</p>`:""}\n                       ${""!=e.imageSrc?`\n                  <div class="item-app__image _imw">\n                   <img src="${e.imageSrc}" alt="Завантажене зображення">\n                \n                </div>\n                `:""}\n                   ${""!=e.time?`<p>${e.time}</p>`:""}\n                </div>\n             </li>`)).join("")}y(o,s),p.addEventListener("change",(function(){const e=[...p.files].filter((e=>function(e){return["image/jpeg","image/jpg","image/png","image/webp"].includes(e.type)?!(e.size>2097152&&(alert("Не більше 2 мегабайт!"),1)):(alert("Тільки зображення!"),!1)}(e)));u.innerHTML="",e.forEach(((e,t)=>{const r=new FileReader;r.readAsDataURL(e),r.onload=function(e){const t=document.createElement("img");t.classList.add("_file-preview-content"),t.src=e.target.result;const r=e.target.result;g=r;const o=document.createElement("div");o.classList.add("_file-wrapper"),o.classList.add("_imw"),o.appendChild(t),u.appendChild(o)},r.onerror=function(){alert("Error!")}}))})),m.addEventListener("change",(function(){this.checked?(i.style.setProperty("--background","var(--background-dark)"),i.style.setProperty("--app-border","var(--app-border-dark)"),i.style.setProperty("--app-bg","var(--app-bg-dark)"),i.style.setProperty("--main-title","var(--main-title-dark)"),i.style.setProperty("--label-title","var(--label-title-dark)"),i.style.setProperty("--text-item","var(--text-item-dark)"),i.style.setProperty("--checkbox-fill","var(--checkbox-fill-dark)"),i.style.setProperty("--checkbox-border","var(--checkbox-border-dark)"),i.style.setProperty("--input-border","var(--input-border-dark)"),i.style.setProperty("--button","var(--button-dark)")):(i.style.setProperty("--background","var(--background-light)"),i.style.setProperty("--app-border","var(--app-border-light)"),i.style.setProperty("--app-bg","var(--app-bg-light)"),i.style.setProperty("--main-title","var(--main-title-light)"),i.style.setProperty("--label-title","var(--label-title-light)"),i.style.setProperty("--text-item","var(--text-item-light)"),i.style.setProperty("--checkbox-fill","var(--checkbox-fill-light)"),i.style.setProperty("--checkbox-border","var(--checkbox-border-light)"),i.style.setProperty("--input-border","var(--input-border-light)"),i.style.setProperty("--button","var(--button-light)"))})),s.addEventListener("change",(function(e){e.target.matches("input")&&(o[e.target.dataset.i].done=!o[e.target.dataset.i].done,localStorage.setItem("tasks-list",JSON.stringify(o)))})),l.addEventListener("submit",(function(e){e.preventDefault();const t={name:this.querySelector(".add-app__input_name").value,desc:this.querySelector(".add-app__input_desc").value,time:this.querySelector(".add-app__input_time").value,imageSrc:""==g?"":g,done:!1};o.push(t),localStorage.setItem("tasks-list",JSON.stringify(o)),y(o,s),l.reset(),u.innerHTML="",g=""})),d.addEventListener("click",(function(){o.splice(0,o.length),localStorage.setItem("tasks-list",JSON.stringify(o)),y(o,s)})),c.addEventListener("click",(function(){o.every((e=>1==e.done))?o.forEach((e=>{e.done=!1})):(o.every((e=>0==e.done)),o.forEach((e=>{e.done=!0}))),localStorage.setItem("tasks-list",JSON.stringify(o)),y(o,s)}))}))})();